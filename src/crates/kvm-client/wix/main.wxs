<?xml version="1.0" encoding="UTF-8"?>
<!--
  KVM-Over-IP Client - Windows MSI Installer (WiX v4)
  Installs kvm-client.exe to C:\Program Files\KVM-Over-IP\
  with Start Menu and optional Desktop shortcuts.
-->
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
     xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">

  <Package Name="KVM-Over-IP Client"
           Manufacturer="KVM-Over-IP Project"
           Version="0.1.0"
           UpgradeCode="E5F6A7B8-C9D0-1234-EF01-345678901234"
           Language="1033"
           Codepage="1252">

    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />

    <ui:WixUI Id="WixUI_FeatureTree" />
    <WixVariable Id="WixUILicenseRtf" Value="wix\License.rtf" />

    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLDIR" Name="KVM-Over-IP">
        <Component Id="MainExecutable" Guid="F6A7B8C9-D0E1-2345-F012-456789012345">
          <File Id="FileKvmClient"
                Source="kvm-client.exe"
                KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="KVM-Over-IP">
        <Component Id="StartMenuShortcut" Guid="A7B8C9D0-E1F2-3456-0123-567890123456">
          <Shortcut Id="StartMenuShortcutEntry"
                    Name="KVM-Over-IP Client"
                    Description="Receive keyboard and mouse input from KVM master"
                    Target="[INSTALLDIR]kvm-client.exe"
                    WorkingDirectory="INSTALLDIR" />
          <RemoveFolder Id="RemoveProgramsFolder" On="uninstall" />
          <RegistryValue Root="HKCU"
                         Key="Software\KVMOverIP\Client"
                         Name="installed"
                         Type="integer"
                         Value="1"
                         KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="DesktopFolder">
      <Component Id="DesktopShortcut" Guid="B8C9D0E1-F2A3-4567-1234-678901234567">
        <Shortcut Id="DesktopShortcutEntry"
                  Name="KVM-Over-IP Client"
                  Description="Receive keyboard and mouse input from KVM master"
                  Target="[INSTALLDIR]kvm-client.exe"
                  WorkingDirectory="INSTALLDIR" />
        <RegistryValue Root="HKCU"
                       Key="Software\KVMOverIP\Client"
                       Name="desktop"
                       Type="integer"
                       Value="1"
                       KeyPath="yes" />
      </Component>
    </StandardDirectory>

    <Feature Id="ProductFeature" Title="KVM-Over-IP Client" Level="1">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="StartMenuShortcut" />
    </Feature>

    <Feature Id="DesktopFeature" Title="Desktop Shortcut" Level="1">
      <ComponentRef Id="DesktopShortcut" />
    </Feature>

  </Package>
</Wix>
